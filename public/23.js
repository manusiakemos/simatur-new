(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{309:function(e,t,a){"use strict";a.r(t);var s={name:"Backbone",watch:{"stageSize.width":function(e){this.stageSize.width=parseInt(e)},"stageSize.height":function(e){this.stageSize.height=parseInt(e)}},created:function(){this.getData()},data:function(){return{stageSize:{width:0,height:0,scaleX:.1,scaleY:.1,rectangles:[]},selectedShapeName:"",show:!1}},methods:{handleTransformEnd:function(e){var t=this,a=this.stageSize.rectangles.find((function(e){return e.name===t.selectedShapeName}));a.x=e.target.x(),a.y=e.target.y(),a.rotation=e.target.rotation(),a.scaleX=e.target.scaleX(),a.scaleY=e.target.scaleY()},handleStageMouseDown:function(e){if(console.log("handleStageMouseDown"),e.target===e.target.getStage())return this.selectedShapeName="",void this.updateTransformer();if(!("Transformer"===e.target.getParent().className)){var t=e.target.name(),a=this.stageSize.rectangles.find((function(e){return e.name===t}));this.selectedShapeName=a?t:"",this.updateTransformer(),this.updateData(e.target)}},updateTransformer:function(){console.log("updateTransformer");var e=this.$refs.transformer.getNode(),t=e.getStage(),a=this.selectedShapeName,s=t.findOne("."+a);s!==e.node()&&(s?e.nodes([s]):e.nodes([]),e.getLayer().batchDraw())},getData:function(){var e=this;this.axios.get("/api/backbone").then((function(t){e.stageSize=t.data,e.show=!0}))},updateData:function(e){var t=e.attrs;t.draggable=!0;var a=_.findIndex(this.stageSize.rectangles,(function(e){return e.name==t.name}));this.stageSize.rectangles[a]=t},handleDragEnd:function(e){var t=e.target.attrs;t.draggable=!0;this.stageSize.rectangles.find((function(e){return e.name===t.name}))},simpan:function(){var e=this;this.axios.post("/api/backbone",{json:this.stageSize}).then((function(t){e.makeToast(t.data.text,t.data.message)}))},add:function(e){var t;if(0==this.stageSize.rectangles.length)var a=1;else a=_.maxBy(this.stageSize.rectangles,(function(e){return e.id})).id+1;var s="shape-"+a;switch(e){case"circle":t={id:a,name:s,shape:e,rotation:0,x:10,y:10,width:100,height:100,scaleX:1,scaleY:1,fill:"#5d6ce0",draggable:!0,offsetX:0,offsetY:0,skewX:0,skewY:0};break;case"text":t={id:a,"z-index":666,name:s,fill:"#333333",shape:e,rotation:0,x:10,y:10,draggable:!0,text:"Some text on canvas",fontSize:15};break;case"rect":t={id:a,name:s,shape:e,draggable:!0,fill:"#dc266e",rotation:0,x:10,y:10,width:100,height:100,scaleX:1,scaleY:1,offsetX:0,offsetY:0,skewX:0,skewY:0};break;case"line":t={id:a,name:s,shape:e,draggable:!0,x:20,y:200,points:[0,0,100,0],tension:0,closed:!0,stroke:"black",fill:"#333333"}}t?this.stageSize.rectangles.push(t):console.log("x is not defined")},deleteShape:function(e){this.stageSize.rectangles.splice(e,1)}}},n=a(1),i=Object(n.a)(s,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("b-breadcrumb",[a("b-breadcrumb-item",{attrs:{to:"/admin/dashboard"}},[e._v("\n                        Home\n                    ")]),e._v(" "),a("b-breadcrumb-item",{attrs:{active:""}},[e._v("Backbone")])],1)],1)]),e._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"col-lg-3"},[a("div",{staticClass:"py-3 pr-3 pl-3 shadow"},[a("b-btn",{staticClass:"m-1",on:{click:e.simpan}},[e._v("Simpan")]),e._v(" "),a("b-btn",{staticClass:"m-1",on:{click:e.getData}},[e._v("Refresh")]),e._v(" "),a("b-input",{staticClass:"m-1",attrs:{type:"number",placeholder:"height"},model:{value:e.stageSize.height,callback:function(t){e.$set(e.stageSize,"height",t)},expression:"stageSize.height"}}),e._v(" "),a("b-input",{staticClass:"m-1",attrs:{type:"number",placeholder:"width"},model:{value:e.stageSize.width,callback:function(t){e.$set(e.stageSize,"width",t)},expression:"stageSize.width"}}),e._v(" "),a("b-btn",{staticClass:"m-1",on:{click:function(t){return e.add("circle")}}},[e._v("Lingkaran")]),e._v(" "),a("b-btn",{staticClass:"m-1",on:{click:function(t){return e.add("rect")}}},[e._v("Persegi")]),e._v(" "),a("b-btn",{staticClass:"m-1",on:{click:function(t){return e.add("line")}}},[e._v("Garis")]),e._v(" "),a("b-btn",{staticClass:"m-1",on:{click:function(t){return e.add("text")}}},[e._v("Text")]),e._v(" "),e._l(e.stageSize.rectangles,(function(t,s){return a("b-card",{key:s,staticClass:"shadow-sm mb-3",attrs:{"no-title":""}},[a("div",{staticClass:"d-flex align-text-bottom justify-content-between"},[a("span",{staticClass:"display-5"},[e._v(e._s(t.shape)+e._s(t.id))]),e._v(" "),a("b-btn",{attrs:{variant:"danger",size:"sm"},on:{click:function(t){return e.deleteShape(s)}}},[a("span",{staticClass:"fa fa-trash-alt"})])],1),e._v(" "),"text"==t.shape?a("b-form-group",{staticClass:"mt-3"},[a("b-input",{model:{value:t.text,callback:function(a){e.$set(t,"text",a)},expression:"item.text"}})],1):e._e(),e._v(" "),a("b-form-group",[a("b-input",{attrs:{type:"color"},model:{value:t.fill,callback:function(a){e.$set(t,"fill",a)},expression:"item.fill"}})],1)],1)}))],2)]),e._v(" "),a("div",{staticClass:"col-lg-9"},[a("div",{staticClass:"py-3"},[e.show?a("v-stage",{ref:"stage",attrs:{id:"stage",config:e.stageSize},on:{mousedown:e.handleStageMouseDown,touchstart:e.handleStageMouseDown}},[a("v-layer",{ref:"layer"},[e._l(e.stageSize.rectangles,(function(t){return a("v-"+t.shape,{key:t.id,tag:"component",attrs:{config:t},on:{dragend:e.handleDragEnd,transformend:e.handleTransformEnd}})})),e._v(" "),a("v-transformer",{ref:"transformer"})],2)],1):e._e()],1)])])])])}),[],!1,null,null,null);t.default=i.exports}}]);